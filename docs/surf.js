!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=9)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1);class i{constructor(e=0,t=null){this.x=0,this.y=0,this.set(e,t)}set(e,t=null){return e instanceof i?(this.x=e.x,this.y=e.y,this):(this.x=e,this.y=null==t?e:t,this)}add(e){return this.x+=e.x,this.y+=e.y,this}sub(e){return this.x-=e.x,this.y-=e.y,this}mul(e){return this.x*=e,this.y*=e,this}div(e){return this.x/=e,this.y/=e,this}clamp(e,t,n,i){return this.x=r.clamp(this.x,e,t),this.y=r.clamp(this.y,n,i),this}addAngle(e,t){return this.x+=Math.cos(e)*t,this.y+=Math.sin(e)*t,this}swapXy(){const e=this.x;return this.x=this.y,this.y=e,this}normalize(){return this.div(this.length),this}rotate(e){if(0===e)return this;const t=this.x;return this.x=t*Math.cos(e)-this.y*Math.sin(e),this.y=t*Math.sin(e)+this.y*Math.cos(e),this}getAngle(e=null){return null==e?Math.atan2(this.y,this.x):Math.atan2(e.y-this.y,e.x-this.x)}distanceTo(e){const t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)}isInRect(e,t,n,i){return r.isInRange(this.x,e,e+n)&&r.isInRange(this.y,t,t+i)}get length(){return Math.sqrt(this.x*this.x+this.y*this.y)}}t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clamp=function(e,t=0,n=1){return Math.max(t,Math.min(e,n))},t.wrap=function(e,t,n){const r=n-t,i=e-t;if(i>=0)return i%r+t;{let e=r+i%r+t;return e>=n&&(e-=r),e}},t.isInRange=function(e,t,n){return t<=e&&e<=n},t.range=function(e){return[...Array(e).keys()]},t.stableSort=function(e,t){null==t&&(t=((e,t)=>e-t));const n=e.map((e,t)=>[e,t]);return n.sort((e,n)=>{const r=t(e[0],n[0]);return 0!==r?r:e[1]-n[1]}),n.map(e=>e[0])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(){this.pool=t.pool,this.isAlive=!0,this.ticks=0,this.updaterPool=new s,this.priority=1}remove(){this.isAlive&&(null!=this.onRemove&&this.onRemove(),this.isAlive=!1)}update(e,t=1){const n=new i(e,t,this);return this.updaterPool.add(n),n}setPool(e){this.pool=e}setPriority(e){this.priority=e,this.pool.enablePriority()}init(e,...t){this.func=e,e(this,...t),this.pool.add(this)}updateFrame(){this.updaterPool.updateFrame(),this.ticks++}}t.Actor=r;class i{constructor(e,t,n){this.updateFunc=e,this.interval=t,this.actor=n,this.isAlive=!0,this.ticks=0,this.intervalTicks=0,this.func=e}remove(){this.isAlive=!1}setInterval(e){this.interval=e}updateFrame(){this.intervalTicks--,this.intervalTicks<=0&&(this.updateFunc(this,this.actor),this.intervalTicks=this.interval),this.ticks++}}t.Updater=i;class s{constructor(){this.instances=[],this.isRemovingAllInstances=!1,this.isPriorityEnabled=!1}add(e){this.instances.push(e)}updateFrame(){this.isPriorityEnabled&&(this.instances=function(e,t){const n=e.map((e,t)=>[e,t]);return n.sort((e,n)=>{const r=t(e[0],n[0]);return 0!==r?r:e[1]-n[1]}),n.map(e=>e[0])}(this.instances,(e,t)=>t.priority-e.priority));for(let e=0;e<this.instances.length;){const t=this.instances[e];if(t.isAlive&&t.updateFrame(),this.isRemovingAllInstances){this.isRemovingAllInstances=!1;break}t.isAlive?e++:this.instances.splice(e,1)}}get(e){return null==e?this.instances:this.instances.filter(t=>t.func===e)}removeAll(){this.instances.forEach(e=>{e.remove()}),this.instances=[],this.isRemovingAllInstances=!0}enablePriority(){this.isPriorityEnabled=!0}}t.Pool=s,t.pool=new s,t.updaterPool=new s;let o=r;t.spawn=function(e,...t){const n=new o;return n.init(e,...t),n},t.update=function(e,n=1){const r=new i(e,n,null);return t.updaterPool.add(r),r},t.updateFrame=function(){t.pool.updateFrame(),t.updaterPool.updateFrame()},t.reset=function(){t.pool.removeAll(),t.updaterPool.removeAll()},t.setActorClass=function(e){o=e}},function(e,t,n){"use strict";function r(e,n,r,i,s="black"){t.context.fillStyle=s,t.context.fillRect(Math.floor(e*t.pixelRatio),Math.floor(n*t.pixelRatio),Math.floor(r*t.pixelRatio),Math.floor(i*t.pixelRatio))}Object.defineProperty(t,"__esModule",{value:!0}),t.size=100,t.pixelRatio=2,t.init=function(){t.canvas=document.createElement("canvas"),t.canvas.width=t.canvas.height=t.size*t.pixelRatio,t.context=t.canvas.getContext("2d"),document.body.appendChild(t.canvas)},t.background="#ddd",t.clear=function(){r(0,0,t.size,t.size,t.background)},t.fillRect=r},function(e,t,n){window,e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t){var n;!function(e){"use strict";String.fromCharCode;var t=2*+Math.PI,n=16,r=1,i=Math.sin,s=Math.pow,o=Math.abs;e.SampleRate=0,e.Sec=0,e.SetSampleRate=function(t){e.SampleRate=0|t,e.Sec=0|t},e.SetSampleRate(void 0!==a?(new a).sampleRate:44100),e.Sound=function(t){var n=new f(t,e.DefaultModules),r=M(n.getSamplesLeft());return n.generate(r),g(r)},e.Sounds=function(t,n,r){var i={},s={};s._audio=i;var o=[];S(t,function(e,t){s[t]=function(){void 0!==i[t]&&(i[t].currentTime=0,i[t].play())},o.push(t)});var a=0,l=o.length;return function s(){if(0!=o.length){var u=o.shift();i[u]=e.Sound(t[u]),r&&r(u,++a,l),window.setTimeout(s,30)}else n&&n(sounds)}(),s},e.SoundsImmediate=function(t){var n={},r={};return r._audio=n,S(t,function(t,i){n[i]=e.Sound(t),r[i]=function(){void 0!==n[i]&&(n[i].currentTime=0,n[i].play())}}),r};var a=window.AudioContext||window.webkitAudioContext;void 0!==a?(e.Node=function(t,n,r,i,s){var o=t.createScriptProcessor(i,0,1),a=new f(n,r||e.DefaultModules);return o.onaudioprocess=function(e){var t=e.outputBuffer.getChannelData(0);a.generate(t),!s&&a.finished&&setTimeout(function(){o.disconnect()},30)},o},e.Live=function(t,n,r){r=r||2048;var i={},s=new a,o=s.createGain();function l(e,t){var n=s.createBufferSource();if(n.buffer=e,null!=t&&null!=n.playbackRate){const e=Math.pow(2,1/12);n.playbackRate.value=Math.pow(e,t/100)}return n.start=n.start||n.noteOn,n}return o.connect(s.destination),i._context=s,i._volume=o,S(t,function(t,a){i[a]=function(){e.Node(s,t,n,r).connect(o)}}),i._close=function(){s.close()},i._play=function(t){e.Node(s,t,n,r).connect(o)},i._createBuffer=function(t){var n=new f(t,e.DefaultModules),r=M(n.getSamplesLeft());return n.generate(r),i._createBufferFromBlock(r)},i._createEmptyBuffer=function(){return i._createBufferFromBlock([0])},i._createBufferFromBlock=function(t){var n=s.createBuffer(1,t.length,e.SampleRate);return n.getChannelData(0).set(t),n},i._playBuffer=function(e,t,n){var r=l(e,n);r.connect(o),r.start(t)},i._playBufferAndConnect=function(e,t,n,r){var i=l(e,r);i.connect(n),n.connect(o),i.start(t)},i._createGain=function(){return s.createGain()},i}):e.Live=function(e,t,n){return null},e.Module={},e.G={};var l=e.stage={PhaseSpeed:0,PhaseSpeedMod:10,Generator:20,SampleMod:30,Volume:40};function u(e,t){return e.stage-t.stage}function c(e,t){for(var n=0;n<t.length;n+=1){var r=t[n],i=e[r.name]||{};S(r.params,function(e,t){void 0===i[t]&&(i[t]=e.D)}),e[r.name]=i}}function f(t,n){t=t||{},n=n||e.DefaultModules,t="function"==typeof t?t():JSON.parse(JSON.stringify(t)),this.finished=!1,this.state={SampleRate:t.SampleRate||e.SampleRate},(n=n.slice()).sort(u),this.modules=n,c(t,n);for(var r=0;r<this.modules.length;r+=1){var i=this.modules[r];this.modules[r].setup(this.state,t[i.name])}}function h(){return S(e.Module,function(){return{}})}function d(e){for(var t in e)0==x(e[t]).length&&delete e[t]}function p(e){return new Function("$","block","var TAU = Math.PI * 2;\nvar sample;\nvar phase = +$.generatorPhase,\n\tA = +$.generatorA, ASlide = +$.generatorASlide,\n\tB = +$.generatorB, BSlide = +$.generatorBSlide;\n\nfor(var i = 0; i < block.length; i++){\n\tvar phaseSpeed = block[i];\n\tphase += phaseSpeed;\n\tif(phase > TAU){ phase -= TAU };\n\tA += ASlide; B += BSlide;\n   A = A < 0 ? 0 : A > 1 ? 1 : A;\n   B = B < 0 ? 0 : B > 1 ? 1 : B;\n"+e+"\tblock[i] = sample;\n}\n\n$.generatorPhase = phase;\n$.generatorA = A;\n$.generatorB = B;\nreturn block.length;\n")}function g(t){"undefined"!=typeof Float32Array&&m(t instanceof Float32Array,"data must be an Float32Array");var i=r*n>>3,s=e.SampleRate*i,o=function(e){if("undefined"==typeof Uint8Array)for(var t=new Array(e),n=0;n<t.length;n++)t[n]=0;return new Uint8Array(e)}(44+2*t.length),a=0;function l(e){for(var t=0;t<e.length;t+=1)o[a]=e.charCodeAt(t),a++}function u(e,t){t<=0||(o[a]=255&e,a++,u(e>>8,t-1))}return l("RIFF"),u(36+2*t.length,4),l("WAVEfmt "),u(16,4),u(1,2),u(r,2),u(e.SampleRate,4),u(s,4),u(i,2),u(n,2),l("data"),u(2*t.length,4),y(o.subarray(a),t),new Audio("data:audio/wav;base64,"+function(e){for(var t="",n=0;n<e.length;n+=32768){var r=Math.min(n+32768,e.length);t+=String.fromCharCode.apply(null,e.subarray(n,r))}return btoa(t)}(o))}function y(e,t){m(e.length/2==t.length,"the target buffer must be twice as large as the iinput");for(var n=0,r=0;r<t.length;r++){var i=32767*+t[r]|0;i=i<-32768?-32768:32767<i?32767:i,i+=i<0?65536:0,e[n]=255&i,e[++n]=i>>8,n++}}function m(e,t){if(!e)throw new Error(t)}function v(e,t,n){return n=+n,(e=+e)<(t=+t)?+t:e>n?+n:+e}function P(e){return(e=+e)<0?0:e>1?1:+e}function S(e,t){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r],r));return n}function w(e,t){var n=F();return void 0!==e&&(n*=e),void 0!==t&&(n+=t),n}function b(e){return e[e.length*F()|0]}function x(e){var t=[];for(var n in e)t.push(n);return t}function M(e){if("undefined"==typeof Float32Array)for(var t=new Array(e),n=0;n<t.length;n++)t[n]=0;return new Float32Array(e)}e.InitDefaultParams=c,e.Processor=f,f.prototype={generate:function(e){for(var t=0;t<e.length;t+=1)e[t]=0;if(!this.finished){var n=this.state,r=0|e.length;for(t=0;t<this.modules.length;t+=1){var i=0|this.modules[t].process(n,e.subarray(0,r));r=Math.min(r,i)}for(r<e.length&&(this.finished=!0),t=r;t<e.length;t++)e[t]=0}},getSamplesLeft:function(){for(var e=0,t=0;t<this.state.envelopes.length;t+=1)e+=this.state.envelopes[t].N;return 0===e&&(e=3*this.state.SampleRate),e}},e.Module.Frequency={name:"Frequency",params:{Start:{L:30,H:1800,D:440},Min:{L:30,H:1800,D:30},Max:{L:30,H:1800,D:1800},Slide:{L:-1,H:1,D:0},DeltaSlide:{L:-1,H:1,D:0},RepeatSpeed:{L:0,H:3,D:0},ChangeAmount:{L:-12,H:12,D:0},ChangeSpeed:{L:0,H:1,D:0}},stage:l.PhaseSpeed,setup:function(e,n){var r=e.SampleRate;e.phaseParams=n,e.phaseSpeed=n.Start*t/r,e.phaseSpeedMax=n.Max*t/r,e.phaseSpeedMin=n.Min*t/r,e.phaseSpeedMin=Math.min(e.phaseSpeedMin,e.phaseSpeed),e.phaseSpeedMax=Math.max(e.phaseSpeedMax,e.phaseSpeed),e.phaseSlide=1+64*s(n.Slide,3)/r,e.phaseDeltaSlide=s(n.DeltaSlide,3)/(1e3*r),e.repeatTime=0,e.repeatLimit=1/0,n.RepeatSpeed>0&&(e.repeatLimit=n.RepeatSpeed*r),e.arpeggiatorTime=0,e.arpeggiatorLimit=n.ChangeSpeed*r,0==n.ChangeAmount&&(e.arpeggiatorLimit=1/0),e.arpeggiatorMod=1+n.ChangeAmount/12},process:function(e,t){for(var n=+e.phaseSpeed,r=+e.phaseSpeedMin,i=+e.phaseSpeedMax,s=+e.phaseSlide,o=+e.phaseDeltaSlide,a=e.repeatTime,l=e.repeatLimit,u=e.arpeggiatorTime,c=e.arpeggiatorLimit,f=e.arpeggiatorMod,h=0;h<t.length;h++){if(n=(n*=s+=o)<r?r:n>i?i:n,a>l)return this.setup(e,e.phaseParams),h+this.process(e,t.subarray(h))-1;a++,u>c&&(n*=f,u=0,c=1/0),u++,t[h]+=n}return e.repeatTime=a,e.arpeggiatorTime=u,e.arpeggiatorLimit=c,e.phaseSpeed=n,e.phaseSlide=s,t.length}},e.Module.Vibrato={name:"Vibrato",params:{Depth:{L:0,H:1,D:0},DepthSlide:{L:-1,H:1,D:0},Frequency:{L:.01,H:48,D:0},FrequencySlide:{L:-1,H:1,D:0}},stage:l.PhaseSpeedMod,setup:function(e,n){var r=e.SampleRate;e.vibratoPhase=0,e.vibratoDepth=n.Depth,e.vibratoPhaseSpeed=n.Frequency*t/r,e.vibratoPhaseSpeedSlide=1+3*s(n.FrequencySlide,3)/r,e.vibratoDepthSlide=n.DepthSlide/r},process:function(e,n){var r=+e.vibratoPhase,s=+e.vibratoDepth,o=+e.vibratoPhaseSpeed,a=+e.vibratoPhaseSpeedSlide,l=+e.vibratoDepthSlide;if(0==s&&l<=0)return n.length;for(var u=0;u<n.length;u++)(r+=o)>t&&(r-=t),n[u]+=n[u]*i(r)*s,o*=a,s=P(s+=l);return e.vibratoPhase=r,e.vibratoDepth=s,e.vibratoPhaseSpeed=o,n.length}},e.Module.Generator={name:"Generator",params:{Func:{C:e.G,D:"square"},A:{L:0,H:1,D:0},B:{L:0,H:1,D:0},ASlide:{L:-1,H:1,D:0},BSlide:{L:-1,H:1,D:0}},stage:l.Generator,setup:function(t,n){t.generatorPhase=0,"string"==typeof n.Func?t.generator=e.G[n.Func]:t.generator=n.Func,"object"==typeof t.generator&&(t.generator=t.generator.create()),m("function"==typeof t.generator,"generator must be a function"),t.generatorA=n.A,t.generatorASlide=n.ASlide,t.generatorB=n.B,t.generatorBSlide=n.BSlide},process:function(e,t){return e.generator(e,t)}},e.Module.Guitar={name:"Guitar",params:{A:{L:0,H:1,D:1},B:{L:0,H:1,D:1},C:{L:0,H:1,D:1}},stage:l.Generator,setup:function(e,t){e.guitarA=t.A,e.guitarB=t.B,e.guitarC=t.C,e.guitarBuffer=M(65536),e.guitarHead=0;for(var n=e.guitarBuffer,r=0;r<n.length;r++)n[r]=2*F()-1},process:function(e,n){for(var r=65536,i=r-1,s=+e.guitarA,o=+e.guitarB,a=+e.guitarC,l=s+o+a,u=e.guitarHead,c=e.guitarBuffer,f=0;f<n.length;f++){var h=t/n[f]|0,d=u-(h=h>r?r:h)+r&i;c[u]=(c[d-0+r&i]*s+c[d-1+r&i]*o+c[d-2+r&i]*a)/l,n[f]=c[u],u=u+1&i}return e.guitarHead=u,n.length}},e.Module.Filter={name:"Filter",params:{LP:{L:0,H:1,D:1},LPSlide:{L:-1,H:1,D:0},LPResonance:{L:0,H:1,D:0},HP:{L:0,H:1,D:0},HPSlide:{L:-1,H:1,D:0}},stage:l.SampleMod+0,setup:function(e,t){e.FilterEnabled=t.HP>1e-6||t.LP<1-1e-6,e.LPEnabled=t.LP<1-1e-6,e.LP=s(t.LP,3)/10,e.LPSlide=1+100*t.LPSlide/e.SampleRate,e.LPPos=0,e.LPPosSlide=0,e.LPDamping=5/(1+20*s(t.LPResonance,2))*(.01+t.LP),e.LPDamping=1-Math.min(e.LPDamping,.8),e.HP=s(t.HP,2)/10,e.HPPos=0,e.HPSlide=1+100*t.HPSlide/e.SampleRate},enabled:function(e){return e.FilterEnabled},process:function(e,t){if(!this.enabled(e))return t.length;for(var n=+e.LP,r=+e.LPPos,i=+e.LPPosSlide,s=+e.LPSlide,o=+e.LPDamping,a=+e.LPEnabled,l=+e.HP,u=+e.HPPos,c=+e.HPSlide,f=0;f<t.length;f++){(l>1e-6||l<-1e-6)&&(l=(l*=c)<1e-6?1e-6:l>.1?.1:l);var h=r;n=(n*=s)<0?n=0:n>.1?.1:n;var d=t[f];a?(i+=(d-r)*n,i*=o):(r=d,i=0),u+=(r+=i)-h,u*=1-l,t[f]=u}return e.LPPos=r,e.LPPosSlide=i,e.LP=n,e.HP=l,e.HPPos=u,t.length}},e.Module.Phaser={name:"Phaser",params:{Offset:{L:-1,H:1,D:0},Sweep:{L:-1,H:1,D:0}},stage:l.SampleMod+1,setup:function(e,t){e.phaserBuffer=M(1024),e.phaserPos=0,e.phaserOffset=1020*s(t.Offset,2),e.phaserOffsetSlide=4e3*s(t.Sweep,3)/e.SampleRate},enabled:function(e){return o(e.phaserOffsetSlide)>1e-6||o(e.phaserOffset)>1e-6},process:function(e,t){if(!this.enabled(e))return t.length;for(var n=e.phaserBuffer,r=0|e.phaserPos,i=+e.phaserOffset,s=+e.phaserOffsetSlide,o=0;o<t.length;o++){(i+=s)<0&&(i=-i,s=-s),i>1023&&(i=1023,s=0),n[r]=t[o];var a=r-(0|i)+1024&1023;t[o]+=n[a],r=r+1&1023|0}return e.phaserPos=r,e.phaserOffset=i,t.length}},e.Module.Volume={name:"Volume",params:{Master:{L:0,H:1,D:.5},Attack:{L:.001,H:1,D:.01},Sustain:{L:0,H:2,D:.3},Punch:{L:0,H:3,D:1},Decay:{L:.001,H:2,D:1}},stage:l.Volume,setup:function(e,t){var n=e.SampleRate,r=t.Master,i=r*(1+t.Punch);e.envelopes=[{S:0,E:r,N:t.Attack*n|0},{S:i,E:r,N:t.Sustain*n|0},{S:r,E:0,N:t.Decay*n|0}];for(var s=0;s<e.envelopes.length;s+=1){var o=e.envelopes[s];o.G=(o.E-o.S)/o.N}},process:function(e,t){for(var n=0;e.envelopes.length>0&&n<t.length;){for(var r=e.envelopes[0],i=r.S,s=r.G,o=0|Math.min(t.length-n,r.N),a=n+o|0;n<a;n+=1)t[n]*=i,i=v(i+=s,0,10);r.S=i,r.N-=o,r.N<=0&&e.envelopes.shift()}return n}},e.DefaultModules=[e.Module.Frequency,e.Module.Vibrato,e.Module.Generator,e.Module.Filter,e.Module.Phaser,e.Module.Volume],e.DefaultModules.sort(u),e.EmptyParams=h,e._RemoveEmptyParams=d,e.Preset={Reset:function(){return h()},Coin:function(){var e=h();return e.Frequency.Start=w(880,660),e.Volume.Sustain=w(.1),e.Volume.Decay=w(.4,.1),e.Volume.Punch=w(.3,.3),w()<.5&&(e.Frequency.ChangeSpeed=w(.15,.1),e.Frequency.ChangeAmount=w(8,4)),d(e),e},Laser:function(){var e=h();return e.Generator.Func=b(["square","saw","sine"]),w()<.33?(e.Frequency.Start=w(880,440),e.Frequency.Min=w(.1),e.Frequency.Slide=w(.3,-.8)):(e.Frequency.Start=w(1200,440),e.Frequency.Min=e.Frequency.Start-w(880,440),e.Frequency.Min<110&&(e.Frequency.Min=110),e.Frequency.Slide=w(.3,-1)),w()<.5?(e.Generator.A=w(.5),e.Generator.ASlide=w(.2)):(e.Generator.A=w(.5,.4),e.Generator.ASlide=w(.7)),e.Volume.Sustain=w(.2,.1),e.Volume.Decay=w(.4),w()<.5&&(e.Volume.Punch=w(.3)),w()<.33&&(e.Phaser.Offset=w(.2),e.Phaser.Sweep=w(.2)),w()<.5&&(e.Filter.HP=w(.3)),d(e),e},Explosion:function(){var e=h();return e.Generator.Func="noise",w()<.5?(e.Frequency.Start=w(440,40),e.Frequency.Slide=w(.4,-.1)):(e.Frequency.Start=w(1600,220),e.Frequency.Slide=w(-.2,-.2)),w()<.2&&(e.Frequency.Slide=0),w()<.3&&(e.Frequency.RepeatSpeed=w(.5,.3)),e.Volume.Sustain=w(.3,.1),e.Volume.Decay=w(.5),e.Volume.Punch=w(.6,.2),w()<.5&&(e.Phaser.Offset=w(.9,-.3),e.Phaser.Sweep=w(-.3)),w()<.33&&(e.Frequency.ChangeSpeed=w(.3,.6),e.Frequency.ChangeAmount=w(24,-12)),d(e),e},Powerup:function(){var e=h();return w()<.5?e.Generator.Func="saw":e.Generator.A=w(.6),e.Frequency.Start=w(220,440),w()<.5?(e.Frequency.Slide=w(.5,.2),e.Frequency.RepeatSpeed=w(.4,.4)):(e.Frequency.Slide=w(.2,.05),w()<.5&&(e.Vibrato.Depth=w(.6,.1),e.Vibrato.Frequency=w(30,10))),e.Volume.Sustain=w(.4),e.Volume.Decay=w(.4,.1),d(e),e},Hit:function(){var e=h();return e.Generator.Func=b(["square","saw","noise"]),e.Generator.A=w(.6),e.Generator.ASlide=w(1,-.5),e.Frequency.Start=w(880,220),e.Frequency.Slide=-w(.4,.3),e.Volume.Sustain=w(.1),e.Volume.Decay=w(.2,.1),w()<.5&&(e.Filter.HP=w(.3)),d(e),e},Jump:function(){var e=h();return e.Generator.Func="square",e.Generator.A=w(.6),e.Frequency.Start=w(330,330),e.Frequency.Slide=w(.4,.2),e.Volume.Sustain=w(.3,.1),e.Volume.Decay=w(.2,.1),w()<.5&&(e.Filter.HP=w(.3)),w()<.3&&(e.Filter.LP=w(-.6,1)),d(e),e},Select:function(){var e=h();return e.Generator.Func=b(["square","saw"]),e.Generator.A=w(.6),e.Frequency.Start=w(660,220),e.Volume.Sustain=w(.1,.1),e.Volume.Decay=w(.2),e.Filter.HP=.2,d(e),e},Lucky:function(){var t=h();return S(t,function(t,n){S(e.Module[n].params,function(e,n){if(e.C){var r=x(e.C);t[n]=r[r.length*F()|0]}else t[n]=F()*(e.H-e.L)+e.L})}),t.Volume.Master=.4,t.Filter={},d(t),t}},e.G.unoise=p("sample = Math.random();"),e.G.sine=p("sample = Math.sin(phase);"),e.G.saw=p("sample = 2*(phase/TAU - ((phase/TAU + 0.5)|0));"),e.G.triangle=p("sample = Math.abs(4 * ((phase/TAU - 0.25)%1) - 2) - 1;"),e.G.square=p("var s = Math.sin(phase); sample = s > A ? 1.0 : s < A ? -1.0 : A;"),e.G.synth=p("sample = Math.sin(phase) + .5*Math.sin(phase/2) + .3*Math.sin(phase/4);"),e.G.noise=p("if(phase % TAU < 4){__noiseLast = Math.random() * 2 - 1;} sample = __noiseLast;"),e.G.string={create:function(){for(var e=65536,t=e-1,n=M(e),r=0;r<n.length;r++)n[r]=2*F()-1;var i=0;return function(r,s){for(var o=2*Math.PI,a=+r.generatorA,l=+r.generatorASlide,u=+r.generatorB,c=+r.generatorBSlide,f=n,h=0;h<s.length;h++){var d=s[h];u+=c,a=(a+=l)<0?0:a>1?1:a,u=u<0?0:u>1?1:u;var p=i-(o/d|0)+e&t,g=(1*f[p-0+e&t]+f[p-1+e&t]*a+f[p-2+e&t]*u)/(1+a+u);f[i]=g,s[h]=f[i],i=i+1&t}return r.generatorA=a,r.generatorB=u,s.length}}},e.CreateAudio=g,e.DownloadAsFile=function(e){m(e instanceof Audio,"input must be an Audio object"),document.location.href=e.src},e.Util={},e.Util.CopyFToU8=y,e._createFloatArray=M;var A=Math.random;function F(){return A()}e.setRandomFunc=function(e){A=e}}(n={}),e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0);let i,s;t.Preset=r.Preset;let o,a,l={},u={},c=[];const f={c:t.Preset.Coin,l:t.Preset.Laser,e:t.Preset.Explosion,p:t.Preset.Powerup,h:t.Preset.Hit,j:t.Preset.Jump,s:t.Preset.Select,u:t.Preset.Lucky},h=function(e){let t=[];for(let n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t}(f);let d,p=.5,g=!1;function y(e){null!=i&&(i._volume.gain.value=e)}function m(){null!=i&&D(c,e=>e.stop())}function v(e=32,t=.25,n,r=60,i=1,o=0,a=0,l=1,u=!1,c=!1,f=!1,h=!1,p=null){const g=new F(n,P(r),i);if(g.noteInterval=t,null!=d&&u)g.noteRatios=d.noteRatios;else{const t=null!=p?function(e,t){return R(e,()=>s.get()>=t)}(e,p):function(e){let t=B(e,!1),n=4;for(;n<=e;)t=S(t,n),n*=2;return t}(e);g.noteRatios=function(e,t,n,r,i){let o=s.get(),a=s.get(-.5,.5),l=e.length/x.length,u=[];return e.forEach((e,n)=>{let c=Math.floor(n/l),f=n%l;if(i&&c===Math.floor(x.length/2))return u.push(u[f]),void(null!=u[f]&&(o=u[f]));e?(u.push(o),a+=s.get(-.25,.25),o+=a*r,(s.get()<.2||o<=t||o>=1)&&(o-=2*a,a*=-1)):u.push(null)}),u}(t,c?0:-1,0,l,h)}return g.notes=function(e,t,n,r){let i=e.length/x.length;return e.map((e,o)=>{if(null==e)return null;let a=Math.floor(o/i),l=x[a][0],u=w[x[a][1]],c=e;r&&(c=Math.floor(2*c)/2);let f=Math.floor(c),h=Math.floor((c-f)*u.length);for(h+=t+s.getInt(-n,n+1);h>=u.length;)h-=u.length,f++;for(;h<0;)h+=u.length,f--;return 100*(l+12*f+u[h])})}(g.noteRatios,o,a,f),d=g,g}function P(e){return 440*Math.pow(2,(e-69)/12)}function S(e,t){let n=B(t,!1);const r=Math.floor(4*Math.abs(s.get()+s.get()-1));for(let e=0;e<r;e++)n[s.getInt(t-1)]=!0;return _(e,(e,r)=>n[r%t]?!e:e)}t.init=function(e=0,n=120,l=60){i=r.Live({}),y(.1),a=e,s=new class{get(e=1,t=null){return null==t&&(t=e,e=0),this.getToMaxInt()/4294967295*(t-e)+e}getInt(e,t=null){return null==t&&(t=e,e=0),this.getToMaxInt()%(t-e)+e}getPm(){return 2*this.getInt(2)-1}select(e){return e[this.getInt(e.length)]}setSeed(e=null,t=123456789,n=362436069,r=521288629,i=32){this.w=null!=e?e>>>0:Math.floor(4294967295*Math.random())>>>0,this.x=t>>>0,this.y=n>>>0,this.z=r>>>0;for(let e=0;e<i;e++)this.getToMaxInt();return this}getToMaxInt(){const e=this.x^this.x<<11;return this.x=this.y,this.y=this.z,this.z=this.w,this.w=(this.w^this.w>>>19^e^e>>>8)>>>0,this.w}constructor(){this.setSeed(),this.get=this.get.bind(this),this.getToMaxInt=this.getToMaxInt.bind(this)}},r.setRandomFunc(s.get),t.playInterval=60/n,o=1/l*3},t.setSeed=function(e=0){a=e},t.play=function(e="0",t=2,n=null,r=null,o=null){if(null==i)return;if(null!=l[e])return void l[e].play(o);if(s.setSeed(a+L(e)),null==r){let n=f[e[0]];void 0===n&&(n=s.select(h)),r=B(t,n)}const u=null==n?null:P(n);l[e]=new A(r,u),l[e].play(o)},t.playJingle=function(e="0",t=!1,n=57,r=16,o=.25,l=4,c=null,p=null){if(null==i)return;if(null!=u[e])return void u[e].forEach(e=>e.play(p));if(s.setSeed(a+L(e)),M(),d=null,null==c){let t=f[e[0]];void 0===t&&(t=s.select(h)),c=t}let g=.8;t&&(o/=4,g/=2),u[e]=R(l,()=>{const e=Math.floor(3*Math.abs(s.get()+s.get()-1)),i=Math.floor(10*(s.get()+s.get()-1)),a=t?2:Math.abs(s.get()+s.get()-1),l=s.get()<.25,u=!t&&s.get()<.5,f=s.get()<.5,h=t?s.get()<.25:s.get()<.9,d=s.get(.5),p=v(r,o,c,n,g,e,i,a,l,u,f,h,d);return p.isLooping=!1,p}),u[e].forEach(e=>e.play(p))},t.stopJingles=function(){O(u,e=>D(e,e=>e.stop()))},t.setVolume=y,t.setQuantize=function(e){p=e},t.update=function(){if(null==i)return;const e=i._context.currentTime,t=e+o;return O(l,n=>n.update(e,t)),O(u,n=>D(n,n=>n.update(e,t))),D(c,n=>n.update(e,t)),e},t.reset=function(){m(),l={},u={},c=[]},t.playEmpty=function(){if(null==i)return;if(g)return;const e=i._createEmptyBuffer();i._playBuffer(e,0),g=!0},t.resumeAudioContext=function(){i._context.resume()},t.playParam=function(e){null!=i&&i._play(e)},t.playBgm=function(e="0",n=45,r=32,o=.25,l=4,u=[t.Preset.Laser,t.Preset.Select,t.Preset.Hit,t.Preset.Hit],f=null){if(null==i)return;m(),s.setSeed(a+L(e)),M(),d=null;let h=s.select(u);D(c=R(l,()=>{const e=Math.floor(3*Math.abs(s.get()+s.get()-1)),t=Math.floor(10*(s.get()+s.get()-1)),i=Math.abs(s.get()+s.get()-1),a=s.get()<.25;a||(h=s.select(u));const l=s.get()<.5,c=s.get()<.5,f=s.get()<.9;return v(r,o,h,n,.7,e,t,i,a,l,c,f)}),e=>e.play(f))},t.stopBgm=m;const w=[[0,4,7],[0,3,7],[0,4,7,10],[0,4,7,11],[0,3,7,10]],b=[[[0,0],[7,0],[9,1],[4,1]],[[5,0],[0,0],[5,0],[7,0]],[[5,3],[7,2],[4,4],[9,1]],[[9,1],[2,1],[7,0],[0,0]],[[9,1],[5,0],[7,0],[0,0]]];let x;function M(){const e=s.select(b);x=e.map((e,t)=>[s.get()<.7?e[0]:b[s.getInt(b.length)][t][0],s.get()<.7?e[1]:s.getInt(w.length)])}class A{constructor(e,t=null,n=1){this.isPlaying=!1,this.playedTime=null,Array.isArray(e)||(e=[e]),this.buffers=_(e,e=>(e instanceof Function&&(e=e()),e.Volume.Sustain*=n,e.Volume.Decay*=n,null!=t&&(e.Frequency.Start=t),i._createBuffer(e))),this.gainNode=i._createGain()}play(e=null){this.isPlaying=!0,this.volume=e}stop(){this.isPlaying=!1}update(e,n){if(!this.isPlaying)return;this.isPlaying=!1;const r=t.playInterval*p,i=r>0?Math.ceil(e/r)*r:e;(null==this.playedTime||i>this.playedTime)&&(this.playLater(i),this.playedTime=i)}playLater(e,t=null){null==this.volume?D(this.buffers,n=>i._playBuffer(n,e,t)):(this.gainNode.gain.value=this.volume,D(this.buffers,n=>i._playBufferAndConnect(n,e,this.gainNode,t)))}}class F extends A{constructor(){super(...arguments),this.noteIndex=0,this.noteInterval=.25,this.scheduledTime=null,this.isLooping=!0}play(e=null){super.play(e),this.scheduledTime=null}update(e,t){if(this.isPlaying){null==this.scheduledTime&&this.calcFirstScheduledTime(e);for(let t=0;t<9&&!(this.scheduledTime>=e)&&(this.calcNextScheduledTime(),this.isLooping||0!==this.noteIndex);t++);if(this.scheduledTime<e)this.isLooping?this.scheduledTime=null:this.stop();else for(;this.scheduledTime<=t;){if(null!=this.nextNote&&this.playLater(this.scheduledTime,this.nextNote),!this.isLooping&&0===this.noteIndex)return void this.stop();this.calcNextScheduledTime()}}}calcFirstScheduledTime(e){this.scheduledTime=Math.ceil(e/t.playInterval)*t.playInterval-t.playInterval*this.noteInterval,this.noteIndex=0,this.calcNextScheduledTime()}calcNextScheduledTime(){const e=this.notes.length,n=t.playInterval*this.noteInterval;for(let t=0;t<e&&(this.scheduledTime+=n,this.nextNote=this.notes[this.noteIndex],this.noteIndex++,!(this.noteIndex>=e)||(this.noteIndex=0,this.isLooping))&&null==this.nextNote;t++);}}function L(e){let t=0;const n=e.length;for(let r=0;r<n;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return t}function B(e,t){let n=[];for(let r=0;r<e;r++)n.push(t);return n}function R(e,t){let n=[];for(let r=0;r<e;r++)n.push(t(r));return n}function D(e,t){for(let n=0;n<e.length;n++)t(e[n])}function O(e,t){for(let n in e)t(e[n])}function _(e,t){let n=[];for(let r=0;r<e.length;r++)n.push(t(e[r],r));return n}}])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=function(){let e=0,n=32,s=0;t.dotPatterns=[];for(let o=0;o<r;o++){let r=[];for(let t=0;t<5;t++)for(let o=0;o<4;o++)++n>=32&&(e=i[s++],n=0),(1&e)>0&&r.push({x:o,y:t}),e>>=1;t.dotPatterns.push(r)}t.charToIndex=[];for(let e=0;e<128;e++){let n=-2;if(32==e)n=-1;else if(e>=48&&e<58)n=e-48;else if(e>=65&&e<90)n=e-65+10;else{const t="()[]<>=+-*/%&_!?,.:|'\"$@#\\urdl".indexOf(String.fromCharCode(e));t>=0&&(n=t+36)}t.charToIndex.push(n)}};const r=66,i=[1178905252,1864668900,4116998473,376992244,613021335,3915814550,2046400104,2442557817,528062838,292683543,4187935126,3997453977,1398351172,4193325337,2648414617,2037815702,2128188945,2250152313,2571388135,1181324953,1771503001,4098267545,572846664,639910948,1682204194,2217230920,1089531940,251675876,1208634944,2588250404,678422,1678001392,2147500105,1077936132,1145323584,178257988,1685513216,4210713049,3830337194,619979845,4064601412,66]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(7),s=n(1);t.pos=new r.default,t.move=new r.default,t.pressedPos=new r.default,t.targetPos=new r.default,t.isPressed=!1,t.isJustPressed=!1;let o,a,l,u,c=new r.default,f=!1,h=!1,d=!1,p=new r.default,g=!1,y=!1,m=new i.default,v=new r.default,P=new r.default,S=!1;function w(e,t){c.set(e,t),f=h=!0}function b(e,t){c.set(e,t),f||(g=!0)}function x(e){f=!1,null!=u&&u()}t.init=function(e,t,n=new r.default,i=null,s=null,c=!1){o=e,a=new r.default(t.x+2*n.x,t.y+2*n.y),l=n,u=s,(y=c)&&v.set(a.x/2,a.y/2),document.addEventListener("mousedown",e=>{w(e.pageX,e.pageY)}),document.addEventListener("touchstart",e=>{null!=i&&i(),w(e.touches[0].pageX,e.touches[0].pageY)}),document.addEventListener("mousemove",e=>{b(e.pageX,e.pageY)}),document.addEventListener("touchmove",e=>{e.preventDefault(),b(e.touches[0].pageX,e.touches[0].pageY)},{passive:!1}),document.addEventListener("mouseup",e=>{x(e)}),document.addEventListener("touchend",e=>{e.preventDefault(),e.target.click(),x(e)},{passive:!1}),d=!0},t.update=function(){if(!d)return;!function(e,t,n){n.x=((e-o.offsetLeft)/o.clientWidth+.5)*a.x-l.x,n.y=((t-o.offsetTop)/o.clientHeight+.5)*a.y-l.y}(c.x,c.y,t.pos),y&&!t.pos.isInRect(0,0,a.x,a.y)&&(P.length>0?(v.add(P),!s.isInRange(v.x,.1*-a.x,1.1*a.x)&&v.x*P.x>0&&(P.x*=-1),!s.isInRange(v.y,.1*-a.y,1.1*a.y)&&v.y*P.y>0&&(P.y*=-1),m.get()<.05&&P.set(0)):m.get()<.1&&(P.set(0),P.addAngle(m.get(2*Math.PI),(a.x+a.y)*m.get(.01,.03))),m.get()<.05&&(S=!S),t.pos.set(v),f=S);const e=t.isPressed;t.isPressed=f,t.isJustPressed=!e&&h,h=!1,t.isJustPressed&&(t.pressedPos.set(t.pos),p.set(t.pos)),t.move.set(t.pos.x-p.x,t.pos.y-p.y),p.set(t.pos),g?(t.targetPos.set(t.pos),g=!1):t.targetPos.add(t.move)},t.clearJustPressed=function(){t.isJustPressed=!1,t.isPressed=!0},t.resetPressedPointerPos=function(e=1){t.pressedPos.x+=(t.pos.x-t.pressedPos.x)*e,t.pressedPos.y+=(t.pos.y-t.pressedPos.y)*e},t.setTargetPos=function(e){t.targetPos.set(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.setSeed()}get(e=1,t=null){return null==t&&(t=e,e=0),this.next()/4294967295*(t-e)+e}getInt(e,t=null){return null==t&&(t=e,e=0),this.next()%(t-e)+e}getPlusOrMinus(){return 2*this.getInt(2)-1}select(e){return e[this.getInt(e.length)]}setSeed(e=null,t=123456789,n=362436069,r=521288629,i=32){this.w=null!=e?e>>>0:Math.floor(4294967295*Math.random())>>>0,this.x=t>>>0,this.y=n>>>0,this.z=r>>>0;for(let e=0;e<i;e++)this.next();return this}next(){const e=this.x^this.x<<11;return this.x=this.y,this.y=this.z,this.z=this.w,this.w=(this.w^this.w>>>19^e^e>>>8)>>>0,this.w}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(1);t.isPressed=!1,t.isJustPressed=!1,t.stick=new r.default;let s=!1,o=!1,a=!1;const l=i.range(256).map(()=>!1),u=[[39,68,102],[40,83,101,98],[37,65,100],[38,87,104]],c=[[1,0],[0,1],[-1,0],[0,-1]],f=[90,88,67,86,66,78,77,188,190,191,17,16,18,32,13];t.init=function(){document.addEventListener("keydown",e=>{l[e.keyCode]=!0}),document.addEventListener("keyup",e=>{l[e.keyCode]=!1}),a=!0},t.update=function(){if(!a)return;const e=t.isPressed;t.isPressed=!1,t.stick.set(0),u.forEach((e,n)=>{e.forEach(e=>{if(l[e])return t.stick.x+=c[n][0],t.stick.y+=c[n][1],s&&(t.isPressed=!0),!1})}),t.stickAngle=0,t.stick.length>0&&function(e){const n=o?Math.PI/2:Math.PI/4,r=o?2:1;t.stickAngle=i.wrap(Math.round(e/n)*r,0,8),t.stick.set(0),t.stick.addAngle(t.stickAngle*n,1),t.stickAngle++}(t.stick.getAngle()),f.forEach(e=>{if(l[e])return t.isPressed=!0,!1}),t.isJustPressed=!e&&t.isPressed}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(4),i=n(2),s=n(10),o=n(11),a=n(3),l=n(13),u=n(6),c=n(8),f=n(0),h=n(1);let d,p=0;function g(e){e.setRect(5,5),e.addRect(new s.Rect(3,3,{offset:{y:-4}})),e.addRect(new s.Rect(3,3,{offset:{x:-4,y:-6},springRatio:.2})),e.addRect(new s.Rect(3,3,{offset:{x:4,y:-6},springRatio:.2})),e.pos.set(50,20),e.setPriority(.5),e.wallOn=!1,e.onWallCount=0,e.isDead=!1;const t=new f.default(0,-1);e.update(()=>{if(e.isDead)return e.angle+=.2,void(e.vel.y+=.4);e.pos.y>120&&(e.vel.y=-10,e.angle+=2,e.isDead=!0,r.playJingle("l_d",!0),r.stopBgm(),o.endGame()),o.isUsingKeyboard?e.pos.x+=4*c.stick.x:e.pos.x=u.pos.x,e.pos.x=h.clamp(e.pos.x,0,99);const n=o.isUsingKeyboard?c.isPressed:u.isPressed;if(e.vel.y+=n?.06:.24,e.pos.y<0&&(e.pos.y=0,e.vel.y<0&&(e.vel.y*=-.5)),e.wallOn)e.pos.y+=3,e.stepBack(e.wallOn,t)&&(e.vel.y=0,e.onWallCount=10),e.vel.length>.3&&(e.wallOn=!1);else{const n=e.getColliding(y);if(e.vel.y>0&&n){e.stepBack(n,t),e.vel.y=0,e.wallOn=n,e.onWallCount=10;const s=n.score;r.play("h_w"),null!=s&&(i.spawn(m,n.pos,s),n.score=null,r.play("c_ow"))}}if(e.onWallCount>0){e.onWallCount--,(o.isUsingKeyboard?c.isJustPressed:u.isJustPressed)&&(r.play("j_p1"),e.vel.y=-3,e.wallOn&&(e.wallOn.vel.y+=3),e.wallOn=!1,e.onWallCount=0)}})}function y(e,t,n,r,i,s){e.setRect(s,8),e.pos.set(t,n),e.vel.set(r,i);const o=Math.abs(r)+1,u=Math.abs(i)+1;e.score=10*Math.floor(o*o*u*u*50/s+1),e.update(t=>{null!=e.score?(a.fillRect(e.pos.x-8,e.pos.y-3,16,5,a.background),l.draw(`${e.score}`,e.pos.x,e.pos.y-3)):t.remove()})}function m(e,t,n){p+=n,e.pos.set(t),e.vel.y=-1,e.update(()=>{e.vel.y*=.9,l.draw(`${n}`,e.pos.x,e.pos.y-3),e.ticks>60&&e.remove()})}o.init({game:()=>{i.reset(),p=0,r.playBgm(),i.update(()=>{l.draw(`${p}`,1,1,{align:"left"})}),i.spawn(y,50,80,0,.1,99),i.spawn(g),i.update(e=>{e.setInterval(20/o.difficulty),i.spawn(y,o.random.get(99),-5,o.random.get(o.difficulty-1)*o.random.getPlusOrMinus()*2,2*o.random.get(.1,o.difficulty),o.random.get(20,70))})},gameOver:()=>{d=i.update(()=>{l.draw("GAME OVER",50,45)})},title:()=>{null!=d&&d.remove(),i.update(()=>{l.draw("BOARD\nSURF",50,32,{scale:2}),o.ticks%60<30&&l.draw("CLICK OR TAP\nTO START",50,75)})},init:()=>{r.setSeed(2)},screen:a,actorClass:s.Actor})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(2),i=n(3),s=n(0),o=.5;t.Actor=class extends r.Actor{constructor(){super(...arguments),this.pos=new s.default,this.prevPos=new s.default,this.vel=new s.default,this.speed=0,this.angle=0,this.rects=[],this.stepBackVector=new s.default}setRect(e=5,t=5,n={color:"black",offset:{x:0,y:0}}){this.addRect(new a(e,t,n))}addRect(e){this.rects.push(e)}testColliding(e){return this.rects.some(t=>e.rects.some(e=>t.testColliding(e)))}getCollidings(e){return this.pool.get(e).filter(e=>this.testColliding(e))}getColliding(e){const t=this.pool.get(e);for(let e of t)if(this.testColliding(e))return e;return!1}stepBack(e,t){null==t?this.stepBackVector.set(this.prevPos).sub(this.pos):this.stepBackVector.set(t),this.stepBackVector.normalize().div(2);let n=!1;for(let t=0;t<9;t++){if(this.rects.forEach(e=>{e.updatePos(this.pos)}),e instanceof Function){if(!this.getColliding(e))break}else if(!this.testColliding(e))break;n=!0,this.pos.add(this.stepBackVector)}return n}updateFrame(){this.prevPos.set(this.pos),this.pos.add(this.vel),this.rects.forEach(e=>{e.updateFrame(this.pos,this.angle)}),super.updateFrame(),(this.pos.x<-i.size*o||this.pos.x>i.size*(1+o)||this.pos.y<-i.size*o||this.pos.y>i.size*(1+o))&&this.remove()}};class a{constructor(e=5,t=5,n={color:"black",offset:{x:0,y:0},springRatio:void 0}){this.pos=new s.default,this.size=new s.default(5),this.color="black",this.offset=new s.default,this.springRatio=null,this.springAnchor=new s.default,this.vel=new s.default,this.currentOffset=new s.default,this.springOffset=new s.default,this.isFirstFrame=!0,this.size.set(e,t),this.color=n.color||"black",null!=n.offset&&this.offset.set(n.offset.x||0,n.offset.y||0),this.springRatio=n.springRatio}testColliding(e){const t=Math.abs(this.pos.x-e.pos.x),n=Math.abs(this.pos.y-e.pos.y);return t<(this.size.x+e.size.x)/2&&n<(this.size.y+e.size.y)/2}updateFrame(e,t=0){null!=this.springRatio?(this.isFirstFrame&&(this.isFirstFrame=!1,this.pos.set(this.offset).rotate(t).add(e)),this.springOffset.set(this.offset).rotate(t).add(e).sub(this.pos),this.vel.add(this.springOffset.mul(this.springRatio)),this.vel.mul(.9),this.pos.add(this.vel),this.currentOffset.set(this.pos).sub(e)):(this.currentOffset.set(this.offset).rotate(t),this.updatePos(e)),i.fillRect(this.pos.x-this.size.x/2,this.pos.y-this.size.y/2,this.size.x,this.size.y,this.color)}updatePos(e){this.pos.set(e),this.pos.add(this.currentOffset)}}t.Rect=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(2),i=n(4),s=n(12),o=n(5),a=n(6),l=n(8),u=n(0),c=n(7);t.random=new c.default,t.ticks=0,t.difficulty=1,t.isUsingKeyboard=!1;const f=30,h=!1;let d,p,g,y,m;const v=!1;function P(){null!=p&&p(),y="gameOver",t.ticks=0}function S(){requestAnimationFrame(S),i.update(),a.update(),h&&l.update(),m.clear(),r.updateFrame(),function(){("title"===y||"gameOver"===y&&t.ticks>40)&&(a.isPressed||h&&l.isPressed)&&(t.isUsingKeyboard=h&&l.isPressed,y="game",t.ticks=0,d());"gameOver"===y&&t.ticks>180&&w();t.difficulty="game"===y?1+t.ticks/60/f:1}(),t.ticks++,v&&s.capture(m.canvas)}function w(){null!=g&&(y="title",t.ticks=0,g())}t.init=function(e={title:null,game:null,gameOver:null,init:null,screen:null,actorClass:null,isDebugMode:!1}){g=e.title,d=e.game,p=e.gameOver,i.init(),(m=e.screen).init(),o.init(),a.init(m.canvas,new u.default(m.size),new u.default,i.playEmpty,i.resumeAudioContext,e.isDebugMode),h&&l.init(),null!=e.actorClass&&r.setActorClass(e.actorClass),v&&s.setOptions({scale:1}),window.addEventListener("load",()=>{null!=e.init&&e.init(),null!=g?w():P(),S()})},t.endGame=P},function(e,t,n){window,e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t){GIFEncoder=function(){for(var e=0,t={};e<256;e++)t[e]=String.fromCharCode(e);function n(){this.bin=[]}n.prototype.getData=function(){for(var e="",n=this.bin.length,r=0;r<n;r++)e+=t[this.bin[r]];return e},n.prototype.writeByte=function(e){this.bin.push(e)},n.prototype.writeUTFBytes=function(e){for(var t=e.length,n=0;n<t;n++)this.writeByte(e.charCodeAt(n))},n.prototype.writeBytes=function(e,t,n){for(var r=n||e.length,i=t||0;i<r;i++)this.writeByte(e[i])};var r,i,s,o,a,l,u,c,f,h={},d=null,p=-1,g=0,y=!1,m=[],v=7,P=-1,S=!1,w=!0,b=!1,x=10,M="Generated by jsgif (https://github.com/antimatter15/jsgif/)",A=(h.setDelay=function(e){g=Math.round(e/10)},h.setDispose=function(e){e>=0&&(P=e)},h.setRepeat=function(e){e>=0&&(p=e)},h.setTransparent=function(e){d=e},h.setComment=function(e){M=e},h.addFrame=function(e,t){if(null===e||!y||null===o)throw new Error("Please call start method before calling addFrame");var n=!0;try{t?e instanceof ImageData?(a=e.data,sizeset&&r==e.width&&i==e.height||F(e.width,e.height)):e instanceof Uint8ClampedArray?e.length==r*i*4?a=e:(console.log("Please set the correct size: ImageData length mismatch"),n=!1):(console.log("Please provide correct input"),n=!1):(a=e.getImageData(0,0,e.canvas.width,e.canvas.height).data,b||F(e.canvas.width,e.canvas.height)),R(),L(),w&&(C(),T(),p>=0&&k()),D(),""!==M&&O(),_(),w||T(),E(),w=!1}catch(e){n=!1}return n},h.download=function(e){if(null===o||0==S)console.log("Please call start method and add frames and call finish method before calling download");else{e=void 0!==e?e.endsWith(".gif")?e:e+".gif":"download.gif";var t=document.createElement("a");t.download=e,t.href=URL.createObjectURL(new Blob([new Uint8Array(o.bin)],{type:"image/gif"})),t.click()}},h.finish=function(){if(!y)return!1;var e=!0;y=!1;try{o.writeByte(59),S=!0}catch(t){e=!1}return e},function(){s=0,a=null,l=null,u=null,f=null,S=!1,w=!0}),F=(h.setFrameRate=function(e){15!=e&&(g=Math.round(100/e))},h.setQuality=function(e){e<1&&(e=1),x=e},h.setSize=function(e,t){y&&!w||(i=t,(r=e)<1&&(r=320),i<1&&(i=240),b=!0)}),L=(h.start=function(){A();var e=!0;S=!1,o=new n;try{o.writeUTFBytes("GIF89a")}catch(t){e=!1}return y=e},h.cont=function(){return A(),S=!1,o=new n,y=!0},function(){var e=l.length,t=e/3;u=[];var n=new NeuQuant(l,e,x);f=n.process();for(var r=0,i=0;i<t;i++){var o=n.map(255&l[r++],255&l[r++],255&l[r++]);m[o]=!0,u[i]=o}l=null,c=8,v=7,null!==d&&(s=B(d))}),B=function(e){if(null===f)return-1;for(var t=(16711680&e)>>16,n=(65280&e)>>8,r=255&e,i=0,s=16777216,o=f.length,a=0;a<o;){var l=t-(255&f[a++]),u=n-(255&f[a++]),c=r-(255&f[a]),h=l*l+u*u+c*c,d=a/3;m[d]&&h<s&&(s=h,i=d),a++}return i},R=function(){var e=r,t=i;l=[];for(var n=a,s=0,o=0;o<t;o++)for(var u=0;u<e;u++){var c=o*e*4+4*u;l[s++]=n[c],l[s++]=n[c+1],l[s++]=n[c+2]}},D=function(){var e,t;o.writeByte(33),o.writeByte(249),o.writeByte(4),null===d?(e=0,t=0):(e=1,t=2),P>=0&&(t=7&P),t<<=2,o.writeByte(0|t|e),I(g),o.writeByte(s),o.writeByte(0)},O=function(){o.writeByte(33),o.writeByte(254),o.writeByte(M.length),o.writeUTFBytes(M),o.writeByte(0)},_=function(){o.writeByte(44),I(0),I(0),I(r),I(i),w?o.writeByte(0):o.writeByte(128|v)},C=function(){I(r),I(i),o.writeByte(240|v),o.writeByte(0),o.writeByte(0)},k=function(){o.writeByte(33),o.writeByte(255),o.writeByte(11),o.writeUTFBytes("NETSCAPE2.0"),o.writeByte(3),o.writeByte(1),I(p),o.writeByte(0)},T=function(){o.writeBytes(f);for(var e=768-f.length,t=0;t<e;t++)o.writeByte(0)},I=function(e){o.writeByte(255&e),o.writeByte(e>>8&255)},E=function(){new LZWEncoder(r,i,u,c).encode(o)};return h.stream=function(){return o},h.setProperties=function(e,t){y=e,w=t},h},e.exports=GIFEncoder,LZWEncoder=function(){var e,t,n,r,i,s,o,a,l,u,c,f,h={},d=[],p=[],g=0,y=!1,m=0,v=0,P=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],S=[],w=h.LZWEncoder=function(i,s,o,a){e=i,t=s,n=o,r=Math.max(2,a)},b=function(e,t){S[f++]=e,f>=254&&F(t)},x=function(e){M(5003),g=u+2,y=!0,R(u,e)},M=function(e){for(var t=0;t<e;++t)d[t]=-1},A=h.compress=function(e,t){var n,r,i,s,h,m;for(y=!1,a=L(o=l=e),c=1+(u=1<<e-1),g=u+2,f=0,s=B(),m=0,n=5003;n<65536;n*=2)++m;m=8-m,M(5003),R(u,t);e:for(;-1!=(i=B());)if(n=(i<<12)+s,d[r=i<<m^s]!=n){if(d[r]>=0){h=5003-r,0===r&&(h=1);do{if((r-=h)<0&&(r+=5003),d[r]==n){s=p[r];continue e}}while(d[r]>=0)}R(s,t),s=i,g<4096?(p[r]=g++,d[r]=n):x(t)}else s=p[r];R(s,t),R(c,t)},F=(h.encode=function(n){n.writeByte(r),i=e*t,s=0,A(r+1,n),n.writeByte(0)},function(e){f>0&&(e.writeByte(f),e.writeBytes(S,0,f),f=0)}),L=function(e){return(1<<e)-1},B=function(){return 0===i?-1:(--i,255&n[s++])},R=function(e,t){for(m&=P[v],v>0?m|=e<<v:m=e,v+=o;v>=8;)b(255&m,t),m>>=8,v-=8;if((g>a||y)&&(y?(a=L(o=l),y=!1):a=12==++o?4096:L(o)),e==c){for(;v>0;)b(255&m,t),m>>=8,v-=8;F(t)}};return w.apply(this,arguments),h},NeuQuant=function(){var e,t,n,r,i,s={},o=[],a=[],l=[],u=[],c=s.NeuQuant=function(e,s,o){var u,c;for(t=e,n=s,r=o,i=new Array(256),u=0;u<256;u++)i[u]=new Array(4),(c=i[u])[0]=c[1]=c[2]=(u<<12)/256,l[u]=256,a[u]=0},f=(s.map=function(e,t,n){var r,s,a,l,u,c,f;for(u=1e3,f=-1,s=(r=o[t])-1;r<256||s>=0;)r<256&&((a=(c=i[r])[1]-t)>=u?r=256:(r++,a<0&&(a=-a),(l=c[0]-e)<0&&(l=-l),(a+=l)<u&&((l=c[2]-n)<0&&(l=-l),(a+=l)<u&&(u=a,f=c[3])))),s>=0&&((a=t-(c=i[s])[1])>=u?s=-1:(s--,a<0&&(a=-a),(l=c[0]-e)<0&&(l=-l),(a+=l)<u&&((l=c[2]-n)<0&&(l=-l),(a+=l)<u&&(u=a,f=c[3]))));return f},s.process=function(){return function(){var i,s,o,a,l,c,f,g,y,m,v,P,S,w;for(n<1509&&(r=1),e=30+(r-1)/3,P=t,S=0,w=n,m=(v=n/(3*r))/100|0,g=1024,(f=(c=2048)>>6)<=1&&(f=0),i=0;i<f;i++)u[i]=g*(256*(f*f-i*i)/(f*f));for(y=n<1509?3:n%499!=0?1497:n%491!=0?1473:n%487!=0?1461:1509,i=0;i<v;)if(o=(255&P[S+0])<<4,a=(255&P[S+1])<<4,l=(255&P[S+2])<<4,s=p(o,a,l),d(g,s,o,a,l),0!==f&&h(f,s,o,a,l),(S+=y)>=w&&(S-=n),i++,0===m&&(m=1),i%m==0)for(g-=g/e,(f=(c-=c/30)>>6)<=1&&(f=0),s=0;s<f;s++)u[s]=g*(256*(f*f-s*s)/(f*f))}(),f(),function(){var e,t,n,r,s,a,l,u;for(l=0,u=0,e=0;e<256;e++){for(n=e,r=(s=i[e])[1],t=e+1;t<256;t++)(a=i[t])[1]<r&&(n=t,r=a[1]);if(a=i[n],e!=n&&(t=a[0],a[0]=s[0],s[0]=t,t=a[1],a[1]=s[1],s[1]=t,t=a[2],a[2]=s[2],s[2]=t,t=a[3],a[3]=s[3],s[3]=t),r!=l){for(o[l]=u+e>>1,t=l+1;t<r;t++)o[t]=e;l=r,u=e}}for(o[l]=u+255>>1,t=l+1;t<256;t++)o[t]=255}(),function(){for(var e=[],t=new Array(256),n=0;n<256;n++)t[i[n][3]]=n;for(var r=0,s=0;s<256;s++){var o=t[s];e[r++]=i[o][0],e[r++]=i[o][1],e[r++]=i[o][2]}return e}()},function(){var e;for(e=0;e<256;e++)i[e][0]>>=4,i[e][1]>>=4,i[e][2]>>=4,i[e][3]=e}),h=function(e,t,n,r,s){var o,a,l,c,f,h,d;for((l=t-e)<-1&&(l=-1),(c=t+e)>256&&(c=256),o=t+1,a=t-1,h=1;o<c||a>l;){if(f=u[h++],o<c){d=i[o++];try{d[0]-=f*(d[0]-n)/(1<<18),d[1]-=f*(d[1]-r)/(1<<18),d[2]-=f*(d[2]-s)/(1<<18)}catch(e){}}if(a>l){d=i[a--];try{d[0]-=f*(d[0]-n)/(1<<18),d[1]-=f*(d[1]-r)/(1<<18),d[2]-=f*(d[2]-s)/(1<<18)}catch(e){}}}},d=function(e,t,n,r,s){var o=i[t];o[0]-=e*(o[0]-n)/1024,o[1]-=e*(o[1]-r)/1024,o[2]-=e*(o[2]-s)/1024},p=function(e,t,n){var r,s,o,u,c,f,h,d,p,g;for(p=d=~(1<<31),h=f=-1,r=0;r<256;r++)(s=(g=i[r])[0]-e)<0&&(s=-s),(o=g[1]-t)<0&&(o=-o),s+=o,(o=g[2]-n)<0&&(o=-o),(s+=o)<d&&(d=s,f=r),(u=s-(a[r]>>12))<p&&(p=u,h=r),c=l[r]>>10,l[r]-=c,a[r]+=c<<10;return l[f]+=64,a[f]-=65536,h};return c.apply(this,arguments),s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0);let i,s,o;t.options={scale:.5,durationSec:3,keyCode:67,capturingFps:20,appFps:60,isAppendingImgElement:!0,quality:10,downloadFileName:null};let a=0,l=0,u=new Image,c=!1;function f(e){l++;const n=t.options.appFps/t.options.capturingFps;l<n||(l-=n,s||function(e){c?s=[]:(i=t.options.durationSec*t.options.capturingFps,s=p(i,()=>h(e)),o=p(i,()=>!1)),document.addEventListener("keydown",e=>{e.keyCode==t.options.keyCode&&d()})}(e),c&&s.push(h(e)),s[a].drawImage(e,0,0),c||(o[a]=!0),a++,!c&&a>=i&&(a=0))}function h(e){const n=document.createElement("canvas");n.width=e.width*t.options.scale,n.height=e.height*t.options.scale;const r=n.getContext("2d");return r.scale(t.options.scale,t.options.scale),r}function d(){const e=new r;if(e.setRepeat(0),e.setDelay(1e3/t.options.capturingFps),e.setQuality(t.options.quality),e.start(),c)p(a-1,t=>{e.addFrame(s[t])});else{let t=a;p(i,()=>{o[t]&&e.addFrame(s[t]),++t>=i&&(t=0)})}if(e.finish(),null!=t.options.downloadFileName)return e.download(t.options.downloadFileName),null;const n=e.stream().getData(),l=document.createElement("img");return l.src="data:image/gif;base64,"+function(e){for(var t,n,r,i,s,o,a,l="",u=0,c=e.length,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";u<c;)t=e.charCodeAt(u++),n=e.charCodeAt(u++),r=e.charCodeAt(u++),i=t>>2,s=(3&t)<<4|n>>4,o=(15&n)<<2|r>>6,a=63&r,isNaN(n)?o=a=64:isNaN(r)&&(a=64),l=l+f.charAt(i)+f.charAt(s)+f.charAt(o)+f.charAt(a);return l}(n),t.options.isAppendingImgElement&&document.getElementsByTagName("body")[0].appendChild(l),l}function p(e,t){let n=[];for(let r=0;r<e;r++)n.push(t(r));return n}t.capture=f,t.captureSvg=function(e){const n=t.options.appFps/t.options.capturingFps;if(l+1<n)return void l++;const r=(new XMLSerializer).serializeToString(e);u.src="data:image/svg+xml;base64,"+btoa(r),f(u)},t.end=d,t.setOptions=function(e){for(let n in e)t.options[n]=e[n];c=t.options.durationSec<=0}}])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(3),i=n(5);function s(e,t,n,r,s,a){let l=5*a,u=t;"left"===r||(u-="right"===r?e.length*l:e.length*l/2);let c=n;for(let t=0;t<e.length;t++){const n=i.charToIndex[e.charCodeAt(t)];if(-2===n)throw`invalid char: ${e.charAt(t)}`;n>=0&&o(n,u,c,s,a),u+=l}}function o(e,t,n,s,o){const a=i.dotPatterns[e];for(let e=0;e<a.length;e++){const i=a[e];r.fillRect(i.x*o+t,i.y*o+n,o,o,s)}}t.draw=function(e,t,n,r={align:"center",style:"black",scale:1}){const i=r.align||"center",o=r.style||"black",a=r.scale||1;let l=n;e.split("\n").forEach(e=>{s(e,t,l,i,o,a),l+=6*a})},t.drawLine=s}]);